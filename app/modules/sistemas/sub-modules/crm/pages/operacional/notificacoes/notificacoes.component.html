<div class="px-2 pb-3">
  <div [hidden]="childstate">
    <section class="box__btn">
      <button mat-flat-button color="secondary" class="box__btn--btn" (click)="incluirNotificacao()" type="button"
        [id]="utility.getElementId(2, 'notificacao-incluir')"
        [disabled]="!utility.getPermission([Permissoes.GESTAO_COMUNICADOS_CADASTRAR])">
        Incluir notificação
      </button>
    </section>

    <div>
      <app-grid-filter [filter]="filter" (pesquisar)="search($event)" (redefinir)="redefinir()" [radiusTop]="false"
        [showRedefinir]="showRedefinirBtn" (onSearchInput)="searchField($event)"></app-grid-filter>
      <mat-card class="mat-elevation-z8 mt-2 p-0">
        <section class="text-paginator">
          <div class="row d-flex">
            <section class="default-text" *ngIf="paginator">
              Mostrando
              {{
              paginator?.pageSize > totalItems
              ? totalItems
              : paginator?.pageSize
              }}
              de {{ totalItems }} resultados
            </section>
          </div>
        </section>
        <mat-paginator [pageSizeOptions]="[25, 50, 75, 100]" [length]="totalItems" aria-label="Itens por página"
          #paginator>
        </mat-paginator>

        <div>
          <table mat-table [dataSource]="items$ | async">
            <ng-container matColumnDef="titulo">
              <th mat-header-cell *matHeaderCellDef>
                Título
              </th>
              <td mat-cell *matCellDef="let element" [title]="element.titulo" class="column-title-max">{{ element.titulo
                }}</td>
            </ng-container>

            <ng-container matColumnDef="criadoPor">
              <th mat-header-cell *matHeaderCellDef>Criado por</th>
              <td mat-cell *matCellDef="let element" [title]="element.criadoPor" class="column-max-width">{{
                element.criadoPor }}</td>
            </ng-container>

            <ng-container matColumnDef="canal">
              <th mat-header-cell *matHeaderCellDef>
                Canal
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.canal }}
              </td>
            </ng-container>

            <ng-container matColumnDef="categoria">
              <th mat-header-cell *matHeaderCellDef>
                Categoria
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.categoria }}
              </td>
            </ng-container>

            <ng-container matColumnDef="dataInicio">
              <th mat-header-cell *matHeaderCellDef>
                Data início
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.dataInicio ?? '-' }}
              </td>
            </ng-container>

            <ng-container matColumnDef="dataEnvio">
              <th mat-header-cell *matHeaderCellDef>
                Data envio/fim
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.dataEnvio ?? '-' }}
              </td>
            </ng-container>

            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>
                Status
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.statusNotificacao }}
              </td>
            </ng-container>

            <ng-container matColumnDef="acoes">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let element">
                <div>
                  <button mat-button [matMenuTriggerFor]="menu">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #menu="matMenu">
                    <button mat-menu-item (click)="editarNotificacao(element.id)"
                      [id]="utility.getElementId(2, 'editar-consultar', element.id)"
                      [disabled]="!utility.getPermission([Permissoes.GESTAO_COMUNICADOS_CONSULTAR, Permissoes.GESTAO_COMUNICADOS_CADASTRAR])">
                      Editar/Consultar
                    </button>
                    <button mat-menu-item [id]="utility.getElementId(2, 'ativar-inativar', element.id)"
                      *ngIf="element.statusNotificacao != 'Enviado'"
                      [disabled]="!utility.getPermission([Permissoes.GESTAO_COMUNICADOS_CADASTRAR])"
                      (click)="inativarOuAtivarNotificacao(element.id, element.statusNotificacao !== 'Inativo')">
                      {{ element.statusNotificacao == 'Inativo' ? "Ativar" : "Inativar" }}
                    </button>
                  </mat-menu>
                </div>
              </td>
            </ng-container>

            <ng-container matColumnDef="semRegistro">
              <th class="text-center feedBack pt-1" mat-cell *matFooterCellDef colspan="11">
                <img src="./../../../../../../../../assets/img/custom-icons/icon-vazio-artigos.svg" />
                <p class="desk bold text-gray-700"> Não há registros. </p>
              </th>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsNotificacoes"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsNotificacoes"></tr>
            <tr mat-row *matFooterRowDef="['semRegistro']"
              [ngClass]="{'d-none': !(totalItems == 0 || totalItems == undefined) }"></tr>
          </table>
          <section class="text-paginator">
            <div class="row d-flex">
              <section class="default-text">
                Mostrando
                {{
                paginator?.pageSize > totalItems
                ? totalItems
                : paginator?.pageSize
                }}
                de {{ totalItems }} resultados
              </section>
            </div>
          </section>
          <mat-paginator (page)="syncPrimaryPaginator($event)" [pageSize]="paginator.pageSize"
            [pageIndex]="paginator.pageIndex" [length]="paginator.length"
            [pageSizeOptions]="paginator?.pageSizeOptions">
          </mat-paginator>
        </div>
      </mat-card>

    </div>
  </div>

  <router-outlet></router-outlet>
</div>