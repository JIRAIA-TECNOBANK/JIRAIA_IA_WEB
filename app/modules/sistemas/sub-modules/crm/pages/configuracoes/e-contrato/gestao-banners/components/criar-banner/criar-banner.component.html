<div fxLayout="row" fxLayoutGap="15px" fxLayoutAlign="space-between">
    <mat-card fxFlex="70">
        <form [formGroup]="formulario">

            <div fxLayout="row" fxLayoutGap="10px">
                <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>Tipo </mat-label>
                    <mat-select formControlName="tipoBanner" [id]="utility.getElementId(5, 'banner-categoria')">
                        <mat-option> Escolha o tipo</mat-option>
                        <mat-option *ngFor="let tipo of tiposBanners" [value]="tipo.id"> {{ tipo.valor }}
                        </mat-option>
                    </mat-select>
                    <mat-hint>Obrigatório</mat-hint>
                    <mat-error *ngIf="formulario.controls['tipoBanner'].hasError('required')">Obrigatório
                    </mat-error>
                </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutGap="10px" class="mt-1">
                <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>Título</mat-label>
                    <input matInput placeholder="Título" formControlName="titulo"
                        [id]="utility.getElementId(0, 'banner-titulo')" #titulo />
                    <mat-hint>Obrigatório</mat-hint>
                    <mat-hint align="end">{{ titulo.value?.length || 0 }}/150</mat-hint>
                    <mat-error *ngIf="formulario.controls['titulo'].hasError('required')">Obrigatório</mat-error>
                    <mat-error *ngIf="formulario.controls['titulo'].hasError('maxlength')" align="end">{{
                        titulo.value?.length ||
                        0 }}/150</mat-error>
                </mat-form-field>
            </div>


            <div fxLayout="row" fxLayoutGap="10px" class="mt-1">
                <div class="pt-1 toggle-default" fxFlex="100">
                    <input type="file" hidden #fileDropRef id="fileDropRef"
                        (change)="fileBrowseHandler($event.target.files)" [accept]="acceptedTypes">

                    <div class="dropzone" appDragAndDrop (fileDropped)="onFileDropped($event)"
                        (click)="onClickFile(fileDropRef)" [id]="utility.getElementId(2, 'banner-carregar-imagem')"
                        [ngClass]="{ 'disabled': !utility.getPermission([Permissoes.GESTAO_COMUNICADOS_CADASTRAR]) }">
                        <p class="desk bold"><i class="fa-solid fa-folder-open text-primary"></i> Arraste a imagem aqui,
                            ou <u class="text-primary">procure no seu dispositivo</u> </p>
                    </div>

                    <div fxLayout="row" fxLayoutGap="15px" fxLayoutAlign="space-between" class="mt-1 mb-2">
                        <span class="legenda">Formatos PNG, JPG ou GIF.</span>
                        <span class="legenda">Tamanho máximo 10MB </span>
                    </div>
                </div>
            </div>

            <div class="info-warning mr-2 w-100" fxLayout="column" fxLayoutGap="15px">
                <p class="bold my-0">Proporção para os banners do Portal:</p>
                <ul class="pl-2 my-0 ml-1">
                    <li>
                        <p>Banner promocional único: 425x300;</p>
                    </li>
                    <li>
                        <p>Banners carrossel(1,2,3): 872x204.</p>
                    </li>
                </ul>
            </div>

            <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="space-between" class="mt-2">
                <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>Link de direcionamento do banner</mat-label>
                    <input matInput placeholder="Link de direcionamento do banner" formControlName="urlDirecionamento"
                        [id]="utility.getElementId(0, 'banner-url-direcionamento')" />
                </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutGap="10px">
                <div class="pt-1 toggle-default" fxFlex="100">
                    <p class="bold desk mt-0 text-gray-800">Programar envio</p>

                    <mat-radio-group [formControl]="formulario.get('tipoFrequencia')"
                        class="justify-content-center text-center" [id]="utility.getElementId(3, 'banner-programar-envio')">
                        <mat-radio-button [value]="1" class="mb-2">Mostrar sempre.</mat-radio-button>
                        <br>
                        <mat-radio-button [value]="2" class="mb-2">Mostrar em um período
                            específico.</mat-radio-button>
                    </mat-radio-group>
                </div>
            </div>

            <div fxLayout="row" fxLayoutGap="10px" *ngIf="formulario.get('tipoFrequencia').value == 2">
                <mat-form-field fxFlex="25" appearance="outline">
                    <mat-label>Data início</mat-label>
                    <input [id]="utility.getElementId(0, 'data-inicio')" matInput name="dataInicio"
                        formControlName="dataInicio" placeholder="Digite a data inicial" [min]="minDateInicio"
                        [matDatepicker]="dataInicio" maxlength="10">
                    <mat-datepicker-toggle matSuffix [for]="dataInicio"></mat-datepicker-toggle>
                    <mat-datepicker #dataInicio></mat-datepicker>
                    <mat-hint>Obrigatório</mat-hint>
                    <mat-error *ngIf="formulario.get('dataInicio').hasError('required')">Obrigatório
                    </mat-error>
                </mat-form-field>

                <mat-form-field fxFlex="25" appearance="outline">
                    <mat-label>Data fim</mat-label>
                    <input [id]="utility.getElementId(0, 'data-fim')" matInput name="dataFim"
                        formControlName="dataFim" placeholder="Digite a data final"
                        [min]="formulario.get('dataInicio').value" [matDatepicker]="dataFim" maxlength="10">
                    <mat-datepicker-toggle matSuffix [for]="dataFim"></mat-datepicker-toggle>
                    <mat-datepicker #dataFim></mat-datepicker>
                    <mat-hint>Obrigatório</mat-hint>
                    <mat-error *ngIf="formulario.get('dataFim').hasError('required')">Obrigatório
                    </mat-error>
                </mat-form-field>
            </div>

            <div class="info-primary mr-2 w-100" fxLayout="row" fxLayoutGap="15px"><i
                    class="fa-regular fa-memo-circle-info"></i>
                <ul class="pl-2">
                    <li>
                        <p>Se atente ao período em que os banners são programados.</p>
                        <br>
                    </li>
                    <li>
                        <p>Caso haja mais de um banner programado para o mesmo período e tipo, o banner mais recente
                            sempre irá se sobrepor pelo antigo. Por isso se atente a data inicial e final que este
                            banner irá permanecer visível.</p>
                    </li>
                </ul>
            </div>

            <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="end center" class="mt-1">
                <button mat-flat-button color="secondary" type="button" (click)="onClickConfirmar()"
                    [id]="utility.getElementId(2, 'confirmar')" [disabled]="!formulario.valid"
                    *ngIf="utility.getPermission([Permissoes.GESTAO_COMUNICADOS_CADASTRAR])">Confirmar</button>
            </div>

        </form>
    </mat-card>

    <div fxFlex="auto" class="pre-visualizacao">
        <p class="mt-0">Pré-visualização</p>
        <img id="cabecalho" [src]="getImage()" *ngIf="getImage()"
            [ngClass]="{ 'promocional': bannerUnico(), 'carrossel': !bannerUnico() }" />

        <mat-card *ngIf="!getImage() && formulario.get('tipoBanner').value"
            [ngClass]="{ 'promocional': bannerUnico(), 'carrossel': !bannerUnico() }">
            <i class="fa-solid fa-image"></i>
        </mat-card>
    </div>
</div>